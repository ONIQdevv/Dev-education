<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Observer</title>
</head>
<body>
<!--<script src = "https://cdnjs.cloudflare.com/ajax/libs/riot/4.3.2/riot+compiler.min.js"></script>-->
<script src = "https://cdnjs.cloudflare.com/ajax/libs/riot/2.3.11/riot.min.js"></script>
<!--<script src = "https://cdnjs.cloudflare.com/ajax/libs/riot/4.3.2/riot.js"></script>-->

<script>
function Line() {
   var self = riot.observable(this),
       items = [];

   self.on('append', function (item) {
      items.push(item);
   });


   self.decrease = function () {
     items.shift().outLine(self);
     self.trigger('decrease')
   }
}
function Buyer() {
   this.toLine = function (line) {
    line.on('decrease', this.move);
    line.trigger('append', this);
   };
    this.outLine = function (line) {
        line.off('decrease', this.move)
    };
   this.move = function () {
   console.log(" move ")
   }
}

   var line = new Line();
</script>

</body>
</html>

<!--(new Buyer()).toLine(line)-->
<!--(new Buyer()).toLine(line)-->
<!--line.decrease()-->
<!--line.decrease()-->
